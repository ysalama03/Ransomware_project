# Static Antimalware Analyzer

A Python-based tool for static analysis of executable files to detect potential ransomware and malicious behavior without executing the code.

## Features

- **Import Analysis**: Detects suspicious DLLs and function imports commonly used by ransomware
- **Section Analysis**: Identifies unusual or suspicious section names in PE files
- **String Analysis**: Searches for suspicious strings, ransom notes, commands, and patterns
- **Entropy Calculation**: Measures file entropy to detect packed or encrypted code
- **Comprehensive Reporting**: Generates detailed analysis reports with risk scoring

## Installation

### Prerequisites

- Python 3.6 or higher
- The `strings` command-line utility (installed by default on most Unix-based systems)
- For Windows, you'll need to install the Sysinternals `strings` utility or use the fallback Python implementation

### Setup

1. Clone or download this repository
2. Install dependencies:

```bash
pip install -r requirements.txt
```

## Usage

```bash
python static_antimalware.py [file_path]
```

### Options

- `file_path`: Path to the executable file to analyze
- `-q, --quiet`: Quiet mode (only show risk level and score)

## Example

```bash
python static_antimalware.py suspicious_file.exe
```

## Sample Output

```
============================================================
STATIC MALWARE ANALYSIS REPORT
============================================================

FILE: suspicious_file.exe
SIZE: 2453504 bytes
ENTROPY: 7.832546 (Normal: ~5.5-6.5, Suspicious: >7.0)
RISK SCORE: 85/100
RISK LEVEL: HIGH

FINDINGS:

  Suspicious DLLs:
    - advapi32.dll
    - kernel32.dll
    - crypt32.dll
    - wininet.dll

  Suspicious Functions:
    - CryptAcquireContext
    - CryptGenKey
    - CryptEncrypt
    - FindFirstFile
    - FindNextFile
    - WriteFile
    - DeleteFile
    - InternetOpen
    - VirtualAlloc
    - ... (12 more)

  Suspicious Strings:
    - Your files have been encrypted
    - Pay 1 Bitcoin to address
    - Files will be deleted in 48 hours
    - vssadmin delete shadows /all /quiet
    - bcdedit /set {default} recoveryenabled no

  IP Addresses:
    - 192.168.1.10
    - 45.77.123.45

  URLs:
    - http://payment.bitcoin.cc
    - https://ransom-service.com

  Referenced File Extensions:
    - jpg, png, doc, pdf, txt, xls, ppt, mp3, zip

RECOMMENDATION:
  This file shows strong indicators of ransomware behavior.
  Recommend immediate quarantine and further investigation.

DISCLAIMER:
  This is a simple static analysis and may generate false positives.
  For production use, combine with dynamic analysis and updated signatures.
============================================================
```

## How It Works

The analyzer performs static analysis on executable files by examining their structure, imports, strings, and entropy without executing them. It looks for patterns commonly associated with ransomware and other malicious software, including:

1. **Suspicious DLLs and Function Imports**: Checking for imports related to cryptography, file operations, network communication, and system manipulation.

2. **Section Analysis**: Identifying PE sections with unusual names that might indicate packing or obfuscation.

3. **String Analysis**: Extracting and analyzing strings from the binary to find:
   - Ransom note language
   - Commands for destroying backups and recovery options
   - IP addresses and URLs
   - References to many file extensions (typical of ransomware targeting multiple file types)

4. **Entropy Calculation**: Measuring the randomness of the file's bytes to detect encryption, compression, or packing.

Based on these analyses, the tool calculates a risk score and categorizes the file as HIGH, MEDIUM, LOW risk, or CLEAN.

## Limitations

- Static analysis cannot detect all malware, especially sophisticated or heavily obfuscated variants
- May produce false positives, particularly for legitimate software that uses encryption or certain API calls
- Does not provide behavioral analysis which is crucial for complete malware detection
- The tool is intended as a first-line screening mechanism, not a comprehensive security solution

## Recommended Use

Use this tool as part of a multi-layered security approach:
1. Initial screening of suspicious files
2. Combine with dynamic analysis tools and sandbox testing for suspicious results
3. Update the signatures and patterns regularly to match new threats

## License

MIT
